// Generated by CoffeeScript 1.6.2
(function() {
  var createKarmaFileList, fs, start, startKarma;

  fs = require('fs');

  start = function(hem, hemapps, options) {
    if (options == null) {
      options = {};
    }
    return startKarma(hem, hemapps, options);
  };

  startKarma = function(hemapps, options) {
    var testConfig;

    if (options == null) {
      options = {};
    }
    testConfig = fs.existsSync(options.config) && fs.realpathSync(options.config);
    testConfig || (testConfig = {
      configFile: require.resolve("../assets/testacular.conf.js"),
      singleRun: options.singleRun || true,
      basePath: hem.homeDir,
      logLevel: 'error',
      browsers: options.browser && options.browser.split(/[ ,]+/) || ['PhantomJS'],
      files: createKarmaFileList(hemapps)
    });
    return require('karma').server.start(testConfig);
  };

  createKarmaFileList = function(hemapps) {
    var app, fileList, _i, _len;

    fileList = [require.resolve("../node_modules/karma/adapter/lib/jasmine.js"), require.resolve("../node_modules/karma/adapter/jasmine.js")];
    for (_i = 0, _len = hemapps.length; _i < _len; _i++) {
      app = hemapps[_i];
      fileList.push(app.test.target);
    }
    return fileList;
  };

  module.exports.start = start;

}).call(this);
